---
title: VectorGraphics
description: 
published: true
date: 2024-02-13T14:20:28.736Z
tags: event, события, векторная графика, карта, map
editor: markdown
dateCreated: 2024-01-25T07:44:04.628Z
---

# Векторная графика

В общем случае работа с графикой начинается с векторного редактора, всторенного в приложение, где создается sug-файл (по сути JSON с объектами, размещенными на схеме). Потом этот файл можно прикрепить к конфигурации через Медиафайлы в конструкторе, ссылка на схему размещается в контейнере и далее с ним можно работать из обработчиков. Но такой вариант необязательный – файла может не быть. Схема склада, например может быть сгенерирована автоматически. Еще есть так называемый «режим редактирования» уже непосредственно в «экранах», где можно работать с хостом в пользовательском режиме.

Важные принципы по работе с векторной графикой:
 - Элемент контейнера называется "**map**"
 - Экран должен быть с включенным **Disable scrolling for Root Layout**, либо жестко определять размеры карты. Нельзя вписать данный элемент Поле карты если он не имеет ширины или высоты.     
 - Карты, векторный редактор сохраняет в папку «Загрузки»      
 - Можно указывать имя карты в явном виде (по ключу медиафайла), можно через переменную
<details>
<summary>Фотогайд</summary>
<br>
<img src="/files/Pastedimage20240122113018.png" width=400>
<img src="/files/Pastedimage20240122113127.png" width=400> 
<br>
  <img src="/files/Pastedimage20240122113201.png" width=400> 
<img src="/files/Pastedimage20240122113242.png" width=400>
  <br>
<img src="/files/Pastedimage20240122113319.png" width=400> 
  <br>
<img src="/files/Pastedimage20240122113340.png" width=850> 
<br>
<img src="/files/Pastedimage20240122113713.png" width=850>
<br>
<img src="/files/Pastedimage20240122113738.png" width=850> 
</details>

## Работа с ячейками и схемами хранения
**cells** - номер ячейки, который задавали на момент создания.
**map_highlight_cells** – установка цвета ячеек по адресам, параметр - JSON массив цветов и ячеек, например:
```python
color = [{"color": "#f56042",  
          "cells": ["1-1"]}]  
hashMap.put("map_highlight_cells", json.dumps(color))
```
**map_add_move** – задание маршрута (шага) из ячейки в ячейку. 
```Python
hashMap.put("map_add_move",json.dumps([{"from":"1-2","to":"2-2"}]))
```
**map_nav_mode** - включает режим навигации с помощью алгоритмов(может строить пути, которыми в реальной жизни человек не пойдет, но с алгоритмической точки зрения он будет являться самым коротким) 
```Python
hashMap.put("map_nav_mode", "")
```
**map_set_size** - задает относительные размеры холста. Пример параметра:
```Python
hashMap.put("map_set_size",json.dumps({"width":1000,"height":2000})) 
```
**map_add_rows** – добавляет новый ряд ячеек с параметрами x,y – верхний левый угол, количество рядов и строк а также размер ячейки. Также задаются сразу адреса ячеек. Все переменные обязательны. Пример параметра команды: 
```Python
row_list = [{"x": 20,
             "y": 30,
             "row_count": 5,
             "column_count": 1,
             "cell_size": 50,
             "tags": [["1-1","1-2","1-3","1-4","1-5"]]}]`
             
hashMap.put("map_add_rows",json.dumps(row_list)) 
```
**map_clear_rows** - очистка списка рядов

## Работа с событиями и тегами
При работе с объектами, подписанными тегами возникают следующие события c 
`event = MapAction`
где MapAction:
 - map_action_down – нажатие на объект  
 - map_action_up - отпускание объекта    
 - map_text_input – ввод текста в объект
 
## Взаимодействие с объектами, кроме рядов ячеек
**map_set_color** – установить цвет элемента.
```Python
my_set = [{"tag": "arr1",
           "color": "#000000"},
          {"tag": "btn1",
          "color": "#000000"}]
hashMap.put("map_set_color",json.dumps(my_set))
```
**map_set_visibility** – включить/выключить видимость элемента. 
```Python
my_set = [{"tag": "arr2",
           "visible": 0},
          {"tag": "btn2",
           "visible": 1}]
hashMap.put("map_set_visibility",json.dumps(my_set))    
```

## Работа с картой
- **map_edit_mode** – включение режима пользовательского редактирования 
`hashMap.put("map_edit_mode", "")`
- **map_background_picture** – установка фона – картинки. Принципы работы такие же как с картинками в [Simple UI](../GeneralFunctionsOfThePlatform/GeneralFunctionsOfThePlatform) 
- **map_background_html** – установка в качестве картинки html на экране, по сути скриншот содержимого html. 
**Важно!** Данный метод можно вызывать только на экране, где есть html поле, т.е. до экрана в котором присутствует поле карты. Таким образом если нужно передать на редактирование печатную форму/отчет html, то должно быть 2 экрана – сначала html, потом экран редактирования 
- **map_save** – сохранение того, что нарисовал пользователь вместе с фоном. В случае с включенным режимом mm_local возвращается переменная **map_saved_file** с именем файла, куда это записалось, если не включен этот режим то возвращается в **map_saved_base64** 
- **map_zoom** – увеличение карты. Пример «1.5» - увеличение в 1,5 раза 
- **map_move_x** и **map_move_y** – сдвиги по осям. Имеет смысл использовать совместно с **map_zoom**. Можно указывать положительные (вправо, вниз) и отрицательные (влево, вверх)

## Запуск редактора карты в пользовательском режиме
**RunVectorEditor**, "путь к файлу карты.sug" - открывает векторный редактор в режиме редактирования заданного файла, без возможности смены (если файла нет-создает). Доступна только кнопка сохранения. В случае успешного сохранения будет сгенерировано событие "vector_editor" `event == "vector_editor"`

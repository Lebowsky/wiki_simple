---
title: WorkManager
description: 
published: true
date: 2024-02-16T12:58:58.617Z
tags: 
editor: markdown
dateCreated: 2024-02-13T08:04:15.781Z
---

# WorkManager
Преимущества использования WorkManager:
- Задачи будут выполняться даже в случае, если приложение неактивно или отключено.
- Даже после перезагрузки устройства без ограничения по времени. 
- Мы можем установить условия выполнения задачи, например, когда устройство находится на зарядке или имеется интернет-соединение.
-  Периодические задачи будут выполняться по расписанию независимо от обстоятельств.

Когда мы создаем воркер, мы передаем задачу Андроиду, а дальнейшая судьба этой задачи зависит от операционной системы. Нет необходимости в мониторинге выполнения задачи, так как это обязанность операционной системы. ОС также контролирует условия выполнения задачи, такие как доступ к Интернету. Если условие выполнения не выполнено, задача не будет запущена, но как только условие будет выполнено, система автоматически начнет выполнение задачи. В то же время, Simple продолжает свою работу независимо.


> **[Однократные фоновые задания](/Documentation/WorkManager/OneTimeTasks)**
{.is-info}

> **[Периодические задания](/Documentation/WorkManager/PeriodicTasks)**
{.is-info}

> **[Остановка задач](/Documentation/WorkManager/StoppingTasks)**
{.is-info}

> **[Особые воркеры для скачивания и отправки файлов](/Documentation/WorkManager/SpecialWorkers)**
{.is-info}

## Периодические задания
Выполняются с определенной периодичностью, определение задачи такое же, как у однократной, только указывается период. RETRY для периодических не работает. 
```Python
hashMap.put("StartPeriodicWork", {"work": "массив обработчиков",
                                  "period": "период",
                                  "tag": "тэг задачи",
                                  "conditions": "список условий"})  
```

- work - унифицированный массив обработчиков, `[{"action":"run","type":"python","method":"some_longtime_routine"}]`
- period - период задается в минутах, не менее 15 минут. Если указано менее 15 минут, то будет выполняться раз в 15 минут.
- tag - нужен для того, чтобы в случае чего по нему можно было обратиться и отменить выполнение.
- conditions - устанавливает условия запуска задачи, их может быть одно или несколько сразу (разделитель – “;”). Условия следующие:
    - CONNECTED – наличие связи
    - CHARGING – устройство находится на зарядке
    - BATTERY_NOT_LOW – заряд батареи достаточен
    - IDLE – устройство не используется
    
```Python
def run_periodic_worker(hashMap,_files=None,_data=None):
    if hashMap.get("listener") == "btn_run_periodic": workercode=[{"action":"run","type":"set","method":"beep"}]         
	  hashMap.put("StartPeriodicWork",json.dumps({"work":workercode,"period":15,"tag":"periodic1","conditions":"CONNECTED"},ensure_ascii=False))

    if hashMap.get("listener") == "btn_stop_periodic":
    	hashMap.put("StopWork","periodic1")
    
    return hashMap  
```


